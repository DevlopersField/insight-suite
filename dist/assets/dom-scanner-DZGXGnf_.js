function p(t,s,n){const i=t.querySelector(`meta[${s}="${n}"]`);return(i==null?void 0:i.getAttribute("content"))??""}function y(t=document,s){var h,l;const n=(t instanceof Document?t.title:((h=t.querySelector("title"))==null?void 0:h.textContent)??"")||"",i=p(t,"name","description"),o=((l=t.querySelector('link[rel="canonical"]'))==null?void 0:l.href)??"",r=p(t,"name","robots")||"index, follow",c=p(t,"name","author"),e=(t instanceof Document?t.documentElement.lang:t.getAttribute("lang"))??"",a=t.querySelector("meta[charset]"),u=(a==null?void 0:a.getAttribute("charset"))??"UTF-8",f=p(t,"name","viewport");return{url:s||(typeof window<"u"?window.location.href:""),title:n,titleLength:n.length,description:i,descriptionLength:i.length,canonical:o,robots:r,author:c,language:e,charset:u,viewport:f}}function m(t=document){const s=t.querySelectorAll("h1, h2, h3, h4, h5, h6");return Array.from(s).map((n,i)=>({tag:n.tagName,text:(n.textContent??"").trim().slice(0,200),order:i+1}))}function w(t=document,s){const n=t.querySelectorAll("img"),i=s||(typeof window<"u"?window.location.href:"");return Array.from(n).map(o=>{var a;const r=o.getAttribute("src")||o.getAttribute("data-src")||"";let c=r,e="unknown";if(r&&!r.startsWith("data:"))try{c=new URL(r,i).href}catch{c=r}try{const u=o.getAttribute("currentSrc")||r;if(!u)e="none";else if(u.startsWith("data:")){const f=u.match(/^data:image\/([a-zA-Z0-9+-]+);/);e=f?f[1].split("+")[0]:"data"}else{const f=[/\.(webp|avif|png|jpg|jpeg|svg|gif|ico|bmp)(?:\?|#|$)/i,/[?&](?:format|fm|ext|type|output)=([^&?#]+)/i,/\/(webp|avif|png|jpg|jpeg|svg|gif|ico|bmp)(?:\/|$)/i];for(const h of f){const l=u.match(h);if(l&&l[1]){e=l[1].toLowerCase();break}}if(e==="unknown"){const h=o.closest("picture");if(h){const l=h.querySelector("source");l&&l.type&&(e=((a=l.type.split("/")[1])==null?void 0:a.split("+")[0].toLowerCase())||"unknown")}}if(e==="unknown"){const h=["webp","avif","png","jpg","jpeg","svg","gif","ico","bmp"],l=u.toLowerCase();for(const g of h)if(new RegExp(`\\b${g}\\b|\\.${g}`,"i").test(l)){e=g;break}}}}catch{e="err"}return e==="jpeg"&&(e="jpg"),e==="unknown"&&(e="img"),{src:c,alt:o.getAttribute("alt")??"",title:o.getAttribute("title")??"",width:o.naturalWidth||o.width||0,height:o.naturalHeight||o.height||0,type:e||"img"}})}function d(t=document,s){const n=t.querySelectorAll("a[href]"),i=s?new URL(s).hostname:typeof window<"u"?window.location.hostname:"";return Array.from(n).map(o=>{const r=o,c=r.getAttribute("href")||"";let e=c,a=!1;try{const u=new URL(c,s||(typeof window<"u"?window.location.href:""));e=u.href,a=u.hostname!==i}catch{}return{href:e,text:(r.textContent??"").trim().slice(0,120),rel:r.getAttribute("rel")??"",isExternal:a}})}function A(t=document,s){const n=i=>{if(!i||!s)return i;try{return new URL(i,s).href}catch{return i}};return{ogTitle:p(t,"property","og:title"),ogDescription:p(t,"property","og:description"),ogImage:n(p(t,"property","og:image")),ogUrl:n(p(t,"property","og:url")),ogType:p(t,"property","og:type"),twitterCard:p(t,"name","twitter:card"),twitterTitle:p(t,"name","twitter:title"),twitterDescription:p(t,"name","twitter:description"),twitterImage:n(p(t,"name","twitter:image")),twitterSite:p(t,"name","twitter:site")}}function b(t=document){const s=t.querySelectorAll("iframe"),n=[];return s.forEach(o=>{const r=o.getAttribute("src")||"";if(r.includes("youtube.com")||r.includes("youtu.be")){let c="";try{c=new URL(r).pathname.split("/").pop()||""}catch{}n.push({type:"youtube",id:c,url:r,hasSchema:!1})}else if(r.includes("vimeo.com")){let c="";try{c=new URL(r).pathname.split("/").pop()||""}catch{}n.push({type:"vimeo",id:c,url:r,hasSchema:!1})}}),S(t)&&n.forEach(o=>o.hasSchema=!0),n}function S(t){const s=t.querySelectorAll('script[type="application/ld+json"]');for(const n of Array.from(s))try{const i=n.textContent||"";if(i.includes("VideoObject")){const o=JSON.parse(i);if((Array.isArray(o)?o:[o]).some(c=>c["@type"]==="VideoObject"||Array.isArray(c["@graph"])&&c["@graph"].some(e=>e["@type"]==="VideoObject")))return!0}}catch{}return!1}function j(t=document){const s=t.querySelectorAll('script[type="application/ld+json"]'),n=[];return s.forEach(i=>{try{const o=i.textContent||"",r=JSON.parse(o);(Array.isArray(r)?r:[r]).forEach(e=>{const a=e["@type"]||"unknown",u=[],f=[];a==="Article"||a==="NewsArticle"||a==="BlogPosting"?(e.headline||u.push("Missing required property 'headline'"),e.image||f.push("Missing property 'image'")):a==="Product"?(e.name||u.push("Missing required property 'name'"),e.offers||f.push("Missing property 'offers'")):a==="Organization"&&(e.name||u.push("Missing required property 'name'"),e.url||f.push("Missing property 'url'")),n.push({type:Array.isArray(a)?a.join(", "):a,data:e,isValid:u.length===0,errors:u,warnings:f})})}catch{}}),n}function q(t=document,s){const n=y(t,s),i=m(t),o=w(t,s),r=d(t,s),c=A(t,s),e=b(t),a=j(t);return{...n,headers:i,images:o,links:r,social:c,videos:e,schemas:a}}export{y as scanBasicSEO,q as scanDOM,m as scanHeaders,w as scanImages,d as scanLinks,j as scanSchemas,A as scanSocialTags,b as scanVideos};

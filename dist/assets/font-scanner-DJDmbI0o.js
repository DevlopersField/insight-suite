function y(s){return`https://fonts.google.com/specimen/${encodeURIComponent(s.trim())}`}function m(s){try{const t=new URL(s),r=[],a=t.searchParams.getAll("family");for(const o of a){const n=o.split(":")[0].replace(/\+/g," ").trim();n&&r.push(n)}if(r.length===0){const o=t.searchParams.get("family");if(o)for(const n of o.split("|")){const i=n.split(":")[0].replace(/\+/g," ").trim();i&&r.push(i)}}return r}catch{return[]}}function h(s){const t=new Map,r=s.querySelectorAll('link[href*="fonts.googleapis.com"]');for(const a of Array.from(r)){const o=a.getAttribute("href")||"",n=m(o);for(const i of n)t.has(i)||t.set(i,{family:i,source:"google",weights:[],styles:["normal"],url:y(i),cssUrl:o})}return t}function w(s){const t=new Map,r=s.querySelectorAll('link[href*="use.typekit.net"]');for(const a of Array.from(r)){const o=a.getAttribute("href")||"";t.set(`typekit:${o}`,{family:"Adobe Typekit Font",source:"typekit",weights:[],styles:[],url:"https://fonts.adobe.com/",cssUrl:o})}return t}function S(s){const t=new Map,r=s instanceof Document?s:s.ownerDocument;if(!r||!r.fonts)return t;try{r.fonts.forEach(a=>{const o=a.family.replace(/^["']|["']$/g,"").trim();if(!o)return;const n=t.get(o)||{family:o,weights:[],styles:[]},i=a.weight||"400",e=a.style||"normal";n.weights.includes(i)||n.weights.push(i),n.styles.includes(e)||n.styles.push(e),t.set(o,n)})}catch{}return t}function k(s){const t=new Map,r=s instanceof Document?s:s.ownerDocument;if(!r||!r.styleSheets)return t;try{for(const a of Array.from(r.styleSheets)){let o;try{o=a.cssRules}catch{continue}for(const n of Array.from(o))if(n instanceof CSSFontFaceRule){const i=n.style.getPropertyValue("font-family").replace(/^["']|["']$/g,"").trim(),e=n.style.getPropertyValue("src"),l=n.style.getPropertyValue("font-weight")||"400",f=n.style.getPropertyValue("font-style")||"normal";if(!i)continue;const c=t.get(i);if(c)c.weights.includes(l)||c.weights.push(l),c.styles.includes(f)||c.styles.push(f);else{let u="custom",g=null;e.includes("fonts.gstatic.com")||e.includes("fonts.googleapis.com")?u="google":(e.includes("typekit")||e.includes("use.typekit.net"))&&(u="typekit");const p=e.match(/url\(["']?([^"')]+)["']?\)/);p&&(g=p[1]),t.set(i,{family:i,source:u,weights:[l],styles:[f],url:u==="google"?y(i):null,cssUrl:g})}}}}catch{}return t}function F(s){const t=new Map,r=[s instanceof Document?s.body:s,s.querySelector("h1"),s.querySelector("h2"),s.querySelector("p"),s.querySelector("a"),s.querySelector("button")].filter(Boolean);for(const a of r)try{const o=typeof window<"u"?window.getComputedStyle(a):null;if(!o)continue;const n=o.fontFamily;if(!n)continue;const i=n.split(",").map(e=>e.trim().replace(/^["']|["']$/g,""));for(const e of i){if(!e||t.has(e))continue;const f=(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded"].includes(e.toLowerCase()),"system");t.set(e,{family:e,source:f,weights:[o.fontWeight||"400"],styles:[o.fontStyle||"normal"],url:null,cssUrl:null})}}catch{}return t}const d=new Set(["Inter","Roboto","Open Sans","Lato","Montserrat","Poppins","Raleway","Oswald","Source Sans Pro","Source Sans 3","Nunito","Playfair Display","Merriweather","Ubuntu","Noto Sans","PT Sans","Rubik","Work Sans","Fira Sans","Quicksand","Barlow","Mulish","DM Sans","Outfit","Space Grotesk","Plus Jakarta Sans","Manrope","JetBrains Mono","Fira Code","Source Code Pro","IBM Plex Sans","IBM Plex Mono","Libre Franklin","Crimson Text","Bitter","Josefin Sans","Cabin","Karla","Exo 2","Archivo","Overpass","Sora","Lexend","Geist"]);function M(s=document){const t=new Map,r=h(s),a=w(s),o=k(s),n=S(s),i=F(s);for(const[e,l]of r)t.set(e,l);for(const[e,l]of a)t.set(e,l);for(const[e,l]of o)if(t.has(e)){const f=t.get(e);for(const c of l.weights)f.weights.includes(c)||f.weights.push(c);for(const c of l.styles)f.styles.includes(c)||f.styles.push(c)}else t.set(e,l);for(const[e,l]of n){const f=t.get(e);if(f){for(const c of l.weights||[])f.weights.includes(c)||f.weights.push(c);for(const c of l.styles||[])f.styles.includes(c)||f.styles.push(c)}}for(const[e,l]of i)t.has(e)||(d.has(e)&&(l.source="google",l.url=y(e)),t.set(e,l));return Array.from(t.values())}export{M as scanFonts};

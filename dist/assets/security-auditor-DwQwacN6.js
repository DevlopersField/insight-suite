const a=[{header:"Content-Security-Policy",evaluate:e=>e?e.includes("'unsafe-inline'")||e.includes("'unsafe-eval'")?{status:"warn",recommendation:"Remove 'unsafe-inline' and 'unsafe-eval' from CSP for better security"}:{status:"pass",recommendation:"Properly configured"}:{status:"fail",recommendation:"Add a Content-Security-Policy header to prevent XSS attacks"}},{header:"Strict-Transport-Security",evaluate:e=>{if(!e)return{status:"fail",recommendation:"Add HSTS header: max-age=31536000; includeSubDomains; preload"};const t=e.match(/max-age=(\d+)/);return t&&parseInt(t[1])<31536e3?{status:"warn",recommendation:"Increase max-age to at least 31536000 (1 year)"}:e.includes("includeSubDomains")?{status:"pass",recommendation:"Properly configured"}:{status:"warn",recommendation:"Add includeSubDomains directive"}}},{header:"X-Frame-Options",evaluate:e=>e?e.toUpperCase()==="DENY"||e.toUpperCase()==="SAMEORIGIN"?{status:"pass",recommendation:"Properly configured"}:{status:"warn",recommendation:"Set to DENY or SAMEORIGIN"}:{status:"fail",recommendation:"Add X-Frame-Options: DENY or SAMEORIGIN to prevent clickjacking"}},{header:"X-Content-Type-Options",evaluate:e=>e?e.toLowerCase()==="nosniff"?{status:"pass",recommendation:"Properly configured"}:{status:"warn",recommendation:"Set value to 'nosniff'"}:{status:"fail",recommendation:"Add X-Content-Type-Options: nosniff to prevent MIME type sniffing"}},{header:"Referrer-Policy",evaluate:e=>e?["no-referrer","same-origin","strict-origin","strict-origin-when-cross-origin"].includes(e.toLowerCase())?{status:"pass",recommendation:"Properly configured"}:e.toLowerCase()==="unsafe-url"?{status:"warn",recommendation:"Use strict-origin-when-cross-origin instead of unsafe-url"}:{status:"pass",recommendation:"Properly configured"}:{status:"fail",recommendation:"Add Referrer-Policy: strict-origin-when-cross-origin"}},{header:"Permissions-Policy",evaluate:e=>e?{status:"pass",recommendation:"Properly configured"}:{status:"fail",recommendation:"Add Permissions-Policy to restrict browser features (camera, microphone, geolocation)"}}];async function i(e){const t=[];try{if(!e.toLowerCase().startsWith("http"))throw new Error("Invalid protocol");const r=await fetch(e,{method:"HEAD",cache:"no-cache"});for(const n of a){const o=r.headers.get(n.header),s=n.evaluate(o);t.push({header:n.header,value:o,status:s.status,recommendation:s.recommendation})}}catch{for(const r of a)t.push({header:r.header,value:null,status:"warn",recommendation:"Could not fetch headers â€” install Chrome Extension for full audit"})}return t}function c(){return a.map(e=>({header:e.header,value:null,status:"warn",recommendation:"Install the Chrome Extension to audit security headers"}))}export{i as a,c as d};
